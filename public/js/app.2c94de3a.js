(function(e){function t(t){for(var i,a,c=t[0],s=t[1],l=t[2],d=0,f=[];d<c.length;d++)a=c[d],r[a]&&f.push(r[a][0]),r[a]=0;for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i]);u&&u(t);while(f.length)f.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],i=!0,c=1;c<n.length;c++){var s=n[c];0!==r[s]&&(i=!1)}i&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},r={app:0},o=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=s;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0439":function(e,t,n){"use strict";var i=n("237b"),r=n.n(i);r.a},"143e":function(e,t,n){},"237b":function(e,t,n){},"2fbf":function(e,t,n){},"40df":function(e,t,n){},"4b38":function(e,t,n){"use strict";var i=n("143e"),r=n.n(i);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var i=n("2b0e"),r=n("660e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.$mq,attrs:{id:"app"}},[n("div",{staticClass:"login-widget",class:e.$mq},[n("div",{staticClass:"login-widget-header"},[n("img",{attrs:{src:e.logo,height:"70px"}})]),n("div",{staticClass:"login-widget-body",class:e.$mq},[n("div",{staticClass:"login-widget-content-container"},[n("h2",{staticClass:"login-widget-content"},[e._v(e._s(e.headerText))]),e.subheaderText?n("div",{staticClass:"login-widget-content"},[e._v(e._s(e.subheaderText))]):e._e(),e.error?n("Error",{attrs:{error:e.error}}):e._e(),"login"===e.activeView?n("Login",{attrs:{client_id:e.client_id},on:{authenticated:e.handleAuthenticationSuccess,error:function(t){e.error=t}}}):e._e(),"createAccount"===e.activeView?n("CreateAccount",{on:{error:function(t){e.error=t}}}):e._e(),"consent"===e.activeView?n("Consent",{attrs:{client_id:e.client_id,client_name:e.client_name,claims:e.requestedClaims,username:e.authenticatedUsername},on:{show:function(t){e.activeView=t},consentGranted:e.redirect}}):e._e(),"consent"!==e.activeView?n("Links",{attrs:{activeView:e.activeView},on:{show:function(t){e.activeView=t}}}):e._e()],1)])])])},a=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.error?n("div",{staticClass:"login-widget-content login-widget-errors-container"},[n("div",{staticClass:"login-widget-error"},[e._m(0),n("span",{staticStyle:{"padding-left":"0.8rem"}},[e._v(e._s(e.error))])])]):e._e()},s=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"flex",width:"40px",height:"40px","border-right":"1px solid rgb(221, 221, 221)"}},[n("img",{staticStyle:{display:"block",margin:"auto"},attrs:{src:"/alert.svg",height:"25px"}})])}],l={name:"error",props:["error"]},u=l,d=(n("e3d8"),n("2877")),f=Object(d["a"])(u,c,s,!1,null,"83adf10c",null),p=f.exports,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"login-widget-links-container"}},["login"===e.activeView?n("div",[n("div",{staticClass:"login-widget-links",staticStyle:{"justify-content":"space-between"}},[n("a",{staticClass:"login-widget-link",on:{click:function(t){e.showMore=!e.showMore}}},[e._v("Need help signing in?")]),n("a",{staticClass:"login-widget-link",on:{click:function(t){e.showMore=!1,e.$emit("show","createAccount")}}},[e._v("Create account")])]),n("div",{staticClass:"login-widget-links-more",style:{"max-height":e.showMore?"80px":0}},[n("a",{staticClass:"login-widget-link"},[e._v("Recover password")]),n("a",{staticClass:"login-widget-link"},[e._v("Unlock account")])])]):e._e(),"createAccount"===e.activeView?n("div",[n("div",{staticClass:"login-widget-links",staticStyle:{"justify-content":"center"}},[n("a",{staticClass:"login-widget-link",on:{click:function(t){return e.$emit("show","login")}}},[e._v("Back to sign in")])])]):e._e()])},g=[],m={name:"links",props:{activeView:String},data:function(){return{showMore:!1}}},v=m,_=(n("0439"),Object(d["a"])(v,h,g,!1,null,"71b34b94",null)),w=_.exports,b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"login-widget-login-container"}},[e._l(e.fields,function(t){var i=t.key,r=t.placeholder,o=t.value,a=t.touched,c=t.error;return n("TextInput",{key:i,attrs:{password:"password"===i,placeholder:r,value:o,touched:a,error:c},on:{input:function(t){e.updateField(i,"value",t),e.updateField(i,"error",!1)},touched:function(t){return e.updateField(i,"touched",!0)},enter:e.login}})}),n("button",{staticClass:"login-widget-content",on:{click:e.login}},[e._v("Sign in")])],2)},y=[],k=(n("ac6a"),n("7514"),n("db72")),x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("input",{staticClass:"login-widget-content",class:{error:e.danger},attrs:{type:e.password?"password":"text",placeholder:e.placeholder},domProps:{value:e.value},on:{input:function(t){e.$emit("touched"),e.$emit("input",t.target.value)},keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.$emit("touched"),e.$emit("enter")}}})},C=[],O={name:"TextInput",props:{password:{type:Boolean,default:!1},value:String,placeholder:String,touched:Boolean,error:Boolean},computed:{danger:function(){return this.touched&&this.error}},defaultModel:function(){return{value:"",touched:!1,error:!1}}},j=O,S=(n("580e"),Object(d["a"])(j,x,C,!1,null,"022f0719",null)),$=S.exports,M={name:"login",components:{TextInput:$},props:{client_id:String},data:function(){return{fields:[Object(k["a"])({key:"username",placeholder:"Email or Username"},$.defaultModel()),Object(k["a"])({key:"password",placeholder:"Password"},$.defaultModel())]}},methods:{getField:function(e){return this.fields.find(function(t){return t.key===e})},updateField:function(e,t,n){this.fields.find(function(t){return t.key===e})[t]=n},login:function(){var e=this;if(this.fields.forEach(function(t){e.updateField(t.key,"touched",!0),t.value||e.updateField(t.key,"error",!0)}),this.fields.some(function(e){return!e.value}))this.$emit("error","Missing one or more required fields.");else{this.$emit("error",null);var t=this.getField("username").value,n=this.getField("password").value,i=this.client_id;fetch("/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:n,client_id:i})}).then(function(e){return e.json()}).then(function(n){var i=n.consent,r=n.id_token;e.$emit("authenticated",{username:t,consentGranted:i,id_token:r})}).catch(console.error)}}}},T=M,E=(n("a119"),Object(d["a"])(T,b,y,!1,null,"0407d7b6",null)),F=E.exports,A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"login-widget-account-create-container"}},[e._l(e.fields,function(t){var i=t.key,r=t.placeholder,o=t.value,a=t.touched,c=t.error;return n("TextInput",{key:i,attrs:{password:"password"===i,placeholder:r,value:o,touched:a,error:c},on:{input:function(t){e.updateField(i,"value",t),e.updateField(i,"error",!1)},touched:function(t){return e.updateField(i,"touched",!0)},enter:e.createAccount}})}),n("button",{staticClass:"login-widget-content",on:{click:e.createAccount}},[e._v("Create account")])],2)},V=[],P={name:"CreateAccount",components:{TextInput:$},data:function(){return{fields:[Object(k["a"])({key:"username",placeholder:"Username"},$.defaultModel()),Object(k["a"])({key:"email",placeholder:"Email"},$.defaultModel()),Object(k["a"])({key:"password",placeholder:"Password"},$.defaultModel()),Object(k["a"])({key:"firstName",placeholder:"First Name"},$.defaultModel()),Object(k["a"])({key:"lastName",placeholder:"Last Name"},$.defaultModel())]}},methods:{updateField:function(e,t,n){this.fields.find(function(t){return t.key===e})[t]=n},createAccount:function(){var e=this;this.fields.forEach(function(t){e.updateField(t.key,"touched",!0),t.value||e.updateField(t.key,"error",!0)}),this.fields.some(function(e){return!e.value})?this.$emit("error","Missing one or more required fields."):(this.$emit("error",null),console.log("Attempt create account",this.fields.map(function(e){return e.value})))}}},N=P,U=(n("fea3"),Object(d["a"])(N,A,V,!1,null,"3a84d932",null)),q=U.exports,I=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"login-widget-consent-container"}},[n("ul",e._l(e.claimsText,function(t){var i=t[0],r=t[1];return n("li",{key:i},[e._v("\n            "+e._s(r)+"\n        ")])}),0),n("div",{staticClass:"login-widget-allow-text"},[e._v("Allow "+e._s(e.client_name)+" to do this?")]),n("button",{on:{click:e.sendConsent}},[e._v("Allow")]),n("a",{on:{click:function(t){return e.$emit("show","login")}}},[e._v("Cancel")])])},L=[],B={name:"Consent",props:{client_id:String,client_name:String,username:String,claims:Array},data:function(){return{claimsMap:{username:"Username",email:"Email",name:"First and last name"}}},computed:{claimsText:function(){var e=this;return this.claims.map(function(t){return[t,e.claimsMap[t]]})}},methods:{sendConsent:function(){var e=this,t=this.username,n=this.client_id;fetch("/consent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,client_id:n})}).then(function(t){var n=t.id_token;e.$emit("consentGranted",n)}).catch(console.error)}}},J=B,G=(n("4b38"),Object(d["a"])(J,I,L,!1,null,"ed5551ba",null)),R=G.exports,D=JSON.parse(document.getElementById("pageData").innerHTML),H=D.client_id,z=D.redirect_uri,K=D.client_name,Q=D.client_detail,W=D.consent_detail,X=D.logo,Y=D.view,Z={name:"app",components:{Error:p,Links:w,Login:F,CreateAccount:q,Consent:R},data:function(){return{client_id:H,redirect_uri:z,client_name:K,client_detail:Q,consent_detail:W,logo:X||"/logo-full.png",activeView:Y||"login",error:null,authenticatedUsername:null,requestedClaims:["username","email","name"]}},computed:{headerText:function(){return"consent"===this.activeView?"".concat(this.client_name," will have access to:"):"Sign in to access ".concat(this.client_name)},subheaderText:function(){return"consent"===this.activeView?this.consent_detail:this.client_detail}},methods:{handleAuthenticationSuccess:function(e){var t=e.username,n=e.consentGranted,i=e.id_token;this.authenticatedUsername=t,n?this.redirect(i):this.activeView="consent"},redirect:function(e){var t="".concat(this.redirect_uri,"?id_token=").concat(e);console.log("Redirecting to",t),window.history.pushState(null,"",encodeURI(t))}}},ee=Z,te=(n("6bd6"),Object(d["a"])(ee,o,a,!1,null,"4f4ef85d",null)),ne=te.exports;i["a"].config.productionTip=!1,i["a"].use(r["a"],{breakpoints:{mobile:600,desktop:1/0}}),new i["a"]({render:function(e){return e(ne)}}).$mount("#app")},"580e":function(e,t,n){"use strict";var i=n("6e0e"),r=n.n(i);r.a},"6bd6":function(e,t,n){"use strict";var i=n("40df"),r=n.n(i);r.a},"6e0e":function(e,t,n){},"6e9b":function(e,t,n){},a119:function(e,t,n){"use strict";var i=n("fd8d"),r=n.n(i);r.a},e3d8:function(e,t,n){"use strict";var i=n("6e9b"),r=n.n(i);r.a},fd8d:function(e,t,n){},fea3:function(e,t,n){"use strict";var i=n("2fbf"),r=n.n(i);r.a}});
//# sourceMappingURL=app.2c94de3a.js.map